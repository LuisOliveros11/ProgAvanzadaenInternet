<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body{
            background-color: black;
        }
        canvas{
            background-color: gray;
        }
    </style>
</head>
<body>
    <canvas id="myCanvas" width="600" height="500"></canvas>
    <script type="text/javascript">
        const myCanvas = document.getElementById("myCanvas");

        const ctx = myCanvas.getContext("2d");

        class Rectangulo{
            constructor(color, x, y, alto, ancho,velocidad) {
                this.alto = alto;
                this.ancho = ancho;
                this.color = color;
                this.x = x;
                this.y = y;
                this.velocidad = velocidad;
            }

            Colision(objetivo){
                if(this.x < objetivo.x + objetivo.ancho &&  
                   this.x + this.ancho > objetivo.x &&  
                   this.y < objetivo.y + objetivo.alto &&   
                   this.y + this.alto > objetivo.y){ 
                    return true;    
                }
                return false;
            }
        }

        const paredes = [];

        paredes.push(new Rectangulo("Black",110,300,20,300,null));
        paredes.push(new Rectangulo("Black",110,400,20,300,null));
        paredes.push(new Rectangulo("Black",110,50,20,300,null));
        paredes.push(new Rectangulo("Black",450,110,300,20,null));

        var jugador = new Rectangulo("Red", 200, 200, 30, 30, 5);
        var target = new Rectangulo("Yellow", 100, 100, 10, 10, null);
        var direccion = '';
        var marcador = 0;
        var pausa = false;

        function getRandomColor() {
            var trans = '0.5'; // 50% transparency
            color = 'rgba(';
            for (var i = 0; i < 3; i++) {
                color += Math.floor(Math.random() * 255) + ',';
            }
            color += trans + ')'; // add the transparency
            return color;
        }   

        document.addEventListener('keypress', function(e){
            switch(e.keyCode){
                case 119:
                    direccion = 'up';
                break;
                case 115:
                    direccion = 'down';
                break;
                case 97:
                    direccion = 'left';
                break;
                case 100:
                    direccion = 'right';
                break;
                case 32:
                    pausa = !pausa;
                break;
            }
        });

        function update(){
            if(!pausa){
                switch(direccion){
                case 'up':
                if(jugador.y < -20){
                    jugador.y = 500;
                }else{
                    jugador.y -= jugador.velocidad;
                }
                break;
                case 'down':
                if(jugador.y > 520){
                    jugador.y = 0
                }else{
                    jugador.y += jugador.velocidad;
                }
                break;
                case 'left':
                if(jugador.x < -20){
                    jugador.x = 600;
                }else{
                    jugador.x -= jugador.velocidad;
                }
                break;
                case 'right':
                if(jugador.x > 620){
                    jugador.x = 0;
                }else{
                    jugador.x += jugador.velocidad;
                }
                break;
            }
            }
        }

        function pintar(){
            ctx.fillStyle  = 'gray';
            ctx.fillRect(0,0,600,500);
            
            if(pausa){
                ctx.fillStyle = "rgba(210,207,206,0.5)";
                ctx.fillRect(0,0,600,500);

                ctx.fillStyle  = 'white';
                ctx.font = "50px Arial";
                ctx.fillText("P A U S A D O", 120, 230);  
            }

            ctx.fillStyle  = 'white';
            ctx.font = "30px Arial";
            ctx.fillText("Marcador= "+ marcador, 430, 30);   

            ctx.fillStyle  = jugador.color;
            ctx.fillRect(jugador.x,jugador.y,jugador.ancho,jugador.alto);

            ctx.fillStyle  = target.color;
            ctx.fillRect(target.x,target.y,target.ancho,target.alto);

            update();
            requestAnimationFrame(pintar);

            if(jugador.Colision(target)){
                target.x = Math.floor(Math.random() * 255);
                target.y = Math.floor(Math.random() * 255);

                marcador ++;
                jugador.velocidad++;
            }

            paredes.forEach(function (pared, i, array) {
                ctx.fillStyle  = pared.color;
                ctx.fillRect(pared.x,pared.y,pared.ancho,pared.alto);
            });

            paredes.forEach(function (pared, i, array) {
                if(jugador.Colision(pared)){
                switch(direccion){
                case 'up':
                if(jugador.y < -20){
                    jugador.y = 500;
                }else{
                    jugador.y += jugador.velocidad;
                }
                break;
                case 'down':
                if(jugador.y > 520){
                    jugador.y = 0
                }else{
                    jugador.y -= jugador.velocidad;
                }
                break;
                case 'left':
                if(jugador.x < -20){
                    jugador.x = 600;
                }else{
                    jugador.x += jugador.velocidad;
                }
                break;
                case 'right':
                if(jugador.x > 620){
                    jugador.x = 0;
                }else{
                    jugador.x -= jugador.velocidad;
                }
                break;
            }
            } 
            });
        };
        requestAnimationFrame(pintar);

        window.requestAnimationFrame = (function () {
        return window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        function (callback) {
            window.setTimeout(callback, 17);
        };
}());

    </script>
</body>
</html>